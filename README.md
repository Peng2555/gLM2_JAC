# 蛋白质-核酸共演化接触图分析项目

本项目利用预训练的蛋白质语言模型 gLM2-650M 来分析蛋白质序列与核酸序列之间的共演化关系。通过计算序列的雅可比矩阵，项目能够生成接触图（Contact Map），从而可视化两个分子之间可能存在的相互作用位点。

## 主要功能

- **模型驱动分析**: 基于强大的 `gLM2-650M` 模型进行共演化预测。
- **接触图生成**: 计算并生成代表共演化强度的接触图矩阵。
- **灵活的可视化**:
    - 绘制完整的正方形接触图。
    - 绘制指定蛋白质-核酸相互作用区域的子矩阵热力图。

## 项目结构

```
glm2/
│
├── README.md           # 本说明文件
├── requirements.txt    # 项目依赖的Python包
│
├── data/               # 用于存放FASTA等格式的输入序列文件
│
├── models/
│   └── gLM2_650M/      # 存放 gLM2-650M 模型文件
│
├── results/            # 存放生成的接触图图片
│
├── scripts/
│   └── run_analysis.py # 项目的主执行脚本
│
└── src/
    ├── __init__.py
    ├── coevolution_analysis.py # 核心计算逻辑模块
    └── plotting.py     # 可视化绘图模块
```

## 安装指南

请按照以下步骤配置项目运行环境：

1.  **克隆或下载项目**
    ```bash
    # 如果你的项目在Git上
    git clone https://github.com/Peng2555/gLM2_JAC.git
    cd glm2
    ```

2.  **下载预训练模型**
    -   请从官方渠道下载 `gLM2-650M` 模型。
    -   将其解压并确保模型文件夹 `gLM2_650M` 位于项目根目录下的 `models/` 文件夹中。

3.  **创建 Conda 虚拟环境**
    本项目推荐使用 Conda 管理环境，以避免包版本冲突。
    ```bash
    # 创建一个名为 "bg" (或你喜欢的名字) 的新环境
    conda create -n gLM2 python=3.12 -y

    # 激活环境
    conda activate gLM2
    ```

4.  **安装依赖包**
    在项目根目录下，运行以下命令来安装所有必需的 Python 库：
    ```bash
    pip install -r requirements.txt
    ```

## 如何运行

**重要提示**: 由于模块导入机制，请**务必在项目的根目录 (`glm2/`)** 下执行以下命令。

1.  **激活 Conda 环境**
    ```bash
    conda activate gLM2
    ```

2.  **执行分析脚本**
    为了确保 Python 能够正确找到 `src` 模块，我们使用 `PYTHONPATH` 来明确指定搜索路径。
    ```bash
    PYTHONPATH=$(pwd) python scripts/run_analysis.py
    ```
    脚本将开始运行，它会自动加载模型，进行计算，并将最终的图片结果保存在 `results/` 文件夹中。

## 预期输出

脚本成功运行后，你会在 `results/` 文件夹下看到两个图像文件：

-   `TranC_contact_map_full.png`: 包含蛋白质和核酸自身以及它们之间相互作用的完整接触图。
-   `TranC_contact_map_subset.png`: 仅显示蛋白质-核酸相互作用区域的子矩阵热力图。

## 方法简介

本项目的核心思想是利用语言模型的注意力或梯度信息来推断序列位置之间的依赖关系。如果两个位置（无论是氨基酸还是核苷酸）存在共演化关系，那么一个位置的突变会显著影响模型在另一个位置上的预测概率。通过计算雅可比矩阵（模型输出对输入的梯度），我们可以量化这种依赖性，并将其可视化为接触图上的高分值区域。

## 许可证

本项目采用 [MIT License](LICENSE)。